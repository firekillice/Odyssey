(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{408:function(s,e,a){s.exports=a.p+"assets/img/docker-ip.5922ebc2.png"},643:function(s,e,a){"use strict";a.r(e);var n=a(26),r=Object(n.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" DOCKER")]),s._v(" "),n("h2",{attrs:{id:"åŸºç¡€åŸç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŸºç¡€åŸç†"}},[s._v("#")]),s._v(" åŸºç¡€åŸç†")]),s._v(" "),n("ul",[n("li",[s._v("CGROUP(control groups): å¤„ç†è¿›ç¨‹ä½¿ç”¨å®¿ä¸»èµ„æºçš„æ•°é‡æˆ–è€…è§„æ¨¡çš„é—®é¢˜")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" Cgroups allow you to allocate resources â€” such as CPU time, system memory, network bandwidth, or combinations of these resources â€” among user-defined groups of tasks (processes) running on a system. \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("namespace: ä¸ºäº†è®©è¿›ç¨‹ä¹‹é—´è¿›è¡Œéš”ç¦»")]),s._v(" "),n("li",[s._v("UnionFS: ç”¨äºåšåˆ†å±‚ã€é•œåƒå¤ç”¨ã€COW")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("unionFSå¯ä»¥æŠŠæ–‡ä»¶ç³»ç»Ÿä¸Šå¤šä¸ªç›®å½•(ä¹Ÿå«åˆ†æ”¯)å†…å®¹è”åˆæŒ‚è½½åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œè€Œç›®å½•çš„ç‰©ç†ä½ç½®æ˜¯åˆ†å¼€çš„ã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("container(Linux container, LXC): å®¹å™¨æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ï¼Œå¾®æœåŠ¡å‘å±•çš„ä¸€ç§æŠ€æœ¯æ¼”è¿›ï¼›ä¸ä¼ ç»Ÿçš„è™šæ‹ŸåŒ–ç›¸æ¯”æ›´åŠ çš„è½»é‡åŒ–ï¼Œæ›´åŠ è¿…é€Ÿï¼Œè™šæ‹ŸåŒ–æ˜¯ä¸€ç§OSçº§åˆ«çš„ï¼Œå®¹å™¨åˆ™æ˜¯åº”ç”¨çº§åˆ«çš„")]),s._v(" "),n("li",[s._v("veth pair ç½‘å¡ç®¡é“ï¼Œå·¥ç¨‹åŒ–çš„å½¢è±¡ï¼Œå°±åƒçƒ­æ°´æ°´ç®¡ä¸€æ ·æµåŠ¨æ•°æ®")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Linux container ä¸­ç”¨åˆ°ä¸€ä¸ªå«åšvethçš„ä¸œè¥¿ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„è®¾å¤‡ï¼Œä¸“é—¨ä¸º container æ‰€å»ºã€‚veth ä»åå­—ä¸Šæ¥çœ‹æ˜¯ Virtual ETHernet çš„ç¼©å†™ï¼Œå®ƒçš„ä½œç”¨å¾ˆç®€å•ï¼Œå°±æ˜¯è¦æŠŠä»ä¸€ä¸ª network namespace å‘å‡ºçš„æ•°æ®åŒ…è½¬å‘åˆ°å¦ä¸€ä¸ª namespaceã€‚veth è®¾å¤‡æ˜¯æˆå¯¹çš„ï¼Œä¸€ä¸ªæ˜¯ container ä¹‹ä¸­ï¼Œå¦ä¸€ä¸ªåœ¨ container ä¹‹å¤–ï¼Œå³åœ¨çœŸå®æœºå™¨ä¸Šèƒ½çœ‹åˆ°çš„ã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"namespace"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#namespace"}},[s._v("#")]),s._v(" namespace")]),s._v(" "),n("ul",[n("li",[s._v("å®è·µ")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("NS_NAME=ue-testing\nip netns add $NS_NAME\nip netns exec $NS_NAME ifconfig\nip netns exec $NS_NAME bash å¯ä»¥è¿›å…¥å¦ä¸€ä¸ªå‘½åç©ºé—´æ‰§è¡Œå‘½ä»¤\nip netns list æŸ¥çœ‹å‘½åç©ºé—´\nip netns delete $NS_NAME\nethtool -k br-01612ab26dea | grep netns        \nnetns-local: on [fixed] (è¡¨ç¤ºä¸èƒ½è½¬ç§»)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h4",{attrs:{id:"veth-è®¾å¤‡å¯¹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#veth-è®¾å¤‡å¯¹"}},[s._v("#")]),s._v(" veth è®¾å¤‡å¯¹")]),s._v(" "),n("ul",[n("li",[s._v("å¢åŠ è®¾å¤‡å¯¹ ip link add veth0 type veth peer name veth1")]),s._v(" "),n("li",[s._v("å°†veth1è¿ç§»åˆ°å¦å¤–çš„å‘½åç©ºé—´")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ip netns add ns-ue-veth-testing \nip link set veth1 netns ns-ue-veth-testing\nip netns exec ns-ue-veth-testing ip link showï¼Œå¯ä»¥çœ‹åˆ°veth1å·²ç»ç§»åŠ¨åˆ°äº†ns-ue-veth-testing\n    ```\n    1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default qlen 1000\n        link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    71774: veth1@if71775: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\n        link/ether e6:05:1f:08:10:0c brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    ```\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("ç°åœ¨åœ¨vethå¯¹å°±è¿æ¥äº†å®¿ä¸»æœºå’Œns-ue-veth-testingä¸¤ä¸ªå‘½åç©ºé—´")]),s._v(" "),n("li",[s._v("ç»‘å®šipåœ°å€å¹¶ä¸”å¯åŠ¨")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ip netns exec ns-ue-veth-testing  ip addr add 10.10.1.1/24 dev veth1\nip addr add 10.10.1.2/24 dev veth0 \nip netns exec ue-veth-testing ip link set dev eth1 up \nip link set dev veth0 up\nping 10.10.1.1                        \n    PING 10.10.1.1 (10.10.1.1) 56(84) bytes of data.\n    64 bytes from 10.10.1.1: icmp_seq=1 ttl=64 time=0.038 ms\n    64 bytes from 10.10.1.1: icmp_seq=2 ttl=64 time=0.034 ms\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v("æŸ¥çœ‹ç±»å‹")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("> ethtool -i veth0                               \ndriver: veth\nversion: 1.0\nfirmware-version: \nexpansion-rom-version: \nbus-info: \nsupports-statistics: yes\nsupports-test: no\nsupports-eeprom-access: no\nsupports-register-dump: no\nsupports-priv-flags: no\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("ul",[n("li",[s._v("æŸ¥çœ‹è®¾å¤‡ç´¢å¼•")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ethtool -S  veth0\nNIC statistics:\n     peer_ifindex: 71774 (åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œè¯¥å€¼ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ip linkæŸ¥çœ‹)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("åˆ é™¤å‘½åç©ºé—´çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ é™¤ç»‘å®šçš„vethè®¾å¤‡")]),s._v(" "),n("li",[s._v("ç»“æ„å›¾\n"),n("img",{attrs:{src:a(408),alt:"docker-ip"}})])]),s._v(" "),n("h3",{attrs:{id:"bridge"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#bridge"}},[s._v("#")]),s._v(" bridge")]),s._v(" "),n("ul",[n("li",[s._v("å®‰è£…brctl yum install bridge-utils")]),s._v(" "),n("li",[s._v("æŸ¥çœ‹ brctl show")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("bridge name     bridge id               STP enabled     interfaces\nbr-01612ab26dea         8000.0242ef8b5c10       no\nbr-b6a063283195         8000.024235a22119       no\ndocker0         8000.02425b3f82a3       no\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[s._v("brctl addbr br-ue; ifconfig -a")]),s._v(" "),n("li",[s._v("åˆ é™¤: ifconfig br-ue down; brctl delbr br-ue")])]),s._v(" "),n("h3",{attrs:{id:"route"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#route"}},[s._v("#")]),s._v(" route")]),s._v(" "),n("ul",[n("li",[s._v("ip route list")]),s._v(" "),n("li",[s._v("netstat -rn")])]),s._v(" "),n("h3",{attrs:{id:"ç½‘ç»œå¿ƒå¾—"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç½‘ç»œå¿ƒå¾—"}},[s._v("#")]),s._v(" ç½‘ç»œå¿ƒå¾—")]),s._v(" "),n("ul",[n("li",[s._v("é€šè¿‡bridgeã€ routeã€ iptablesã€vethç­‰å°†å®¹å™¨ã€ä¸»æœºè¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªç½‘ç»œ")])]),s._v(" "),n("h2",{attrs:{id:"æµ‹è¯•-å¼€å‘ç¯å¢ƒä¸­å®‰è£…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•-å¼€å‘ç¯å¢ƒä¸­å®‰è£…"}},[s._v("#")]),s._v(" æµ‹è¯•&å¼€å‘ç¯å¢ƒä¸­å®‰è£…")]),s._v(" "),n("ul",[n("li",[s._v("curl -fsSL get.docker.com -o get-docker.sh")]),s._v(" "),n("li",[s._v("sudo sh get-docker.sh --mirror Aliyun")])]),s._v(" "),n("h2",{attrs:{id:"å¯åŠ¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¯åŠ¨"}},[s._v("#")]),s._v(" å¯åŠ¨")]),s._v(" "),n("ul",[n("li",[s._v("sudo systemctl enable docker")]),s._v(" "),n("li",[s._v("sudo systemctl start docker")]),s._v(" "),n("li",[s._v("å…³äºåˆ›å»ºç”¨æˆ·ç»„&ç”¨æˆ·")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œ docker å‘½ä»¤ä¼šä½¿ç”¨ Unix socket ä¸ Docker å¼•æ“é€šè®¯ã€‚è€Œåªæœ‰ root ç”¨æˆ·å’Œdocker ç»„çš„ç”¨æˆ·æ‰å¯ä»¥è®¿é—® Docker å¼•æ“çš„ Unix socketã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸€èˆ¬ Linux ç³»ç»Ÿä¸Šä¸ä¼šç›´æ¥ä½¿ç”¨ root ç”¨æˆ·ã€‚å› æ­¤ï¼Œæ›´å¥½åœ°åšæ³•æ˜¯å°†éœ€è¦ä½¿ç”¨ docker çš„ç”¨æˆ·åŠ å…¥ dockerç”¨æˆ·ç»„ã€‚\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("sudo groupadd docker")]),s._v(" "),n("li",[s._v("sudo usermod -aG docker $USER("),n("strong",[s._v("å°†å½“å‰ç”¨æˆ·åŠ å…¥åˆ°ç”¨æˆ·ç»„")]),s._v(")")]),s._v(" "),n("li",[s._v("æµ‹è¯•æ˜¯å¦å®‰è£…æ­£å¸¸, docker run hello-world")]),s._v(" "),n("li",[s._v("ç®€å•nginxæœåŠ¡å™¨")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -d -p 80:80 --name webserver nginx\nhttp://localhost\ndocker stop webserver\ndocker rm webserver\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"é•œåƒç®¡ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é•œåƒç®¡ç†"}},[s._v("#")]),s._v(" é•œåƒç®¡ç†")]),s._v(" "),n("ul",[n("li",[s._v("centos é•œåƒåŠ é€Ÿ, /etc/docker/daemon.json(æ²¡æœ‰åˆ™åˆ›å»º)")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n    "registry-mirrors": [\n        "https://registry.docker-cn.com"\n    ]\n}\né‡å¯æœåŠ¡\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v("git hub vs docker hubï¼Œ é€šè¿‡URIæ¥å®šä½å…·ä½“èµ„æºçš„ä½ç½®")]),s._v(" "),n("li",[s._v("è·å–é•œåƒçš„å‘½ä»¤æ ¼å¼ docker pull [é€‰é¡¹] [Docker Registry åœ°å€[:ç«¯å£å·]/]ä»“åº“å[:æ ‡ç­¾] , é»˜è®¤åœ°å€æ˜¯docker hubï¼Œ é»˜è®¤ä»“åº“ä¸ºlibrary")]),s._v(" "),n("li",[s._v("docker pull ubuntu:16.04;   docker run -it --rm ubuntu:16.04 bash")]),s._v(" "),n("li",[s._v("docker inspect imageId æŸ¥çœ‹é•œåƒçš„ä¿¡æ¯")])]),s._v(" "),n("h3",{attrs:{id:"list"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#list"}},[s._v("#")]),s._v(" list")]),s._v(" "),n("ul",[n("li",[s._v("docker image ls(åªæ˜¾ç¤ºé¡¶å±‚é•œåƒ), é•œåƒ ID åˆ™æ˜¯é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REPOSITORY    TAG       IMAGE ID       CREATED        SIZE\nnginx         latest    d1a364dc548d   3 weeks ago    133MB\nubuntu        16.04     9ff95a467e45   4 weeks ago    135MB\nhello-world   latest    d1165f221234   3 months ago   13.3kB\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[s._v("options")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(' docker image ls -f dangling=trueï¼Œæ˜¾ç¤ºè™šæ‚¬é•œåƒï¼› docker image pruneåˆ é™¤è™šæ‚¬é•œåƒ\n docker image ls -a æ˜¾ç¤ºæ‰€æœ‰é•œåƒï¼ŒåŒ…æ‹¬ä¸­é—´å±‚é•œåƒ\n docker image ls ubuntu, docker image ls ubuntu:16.04\n docker image ls -f since=mongo:3.2, docker image ls -f before=mongo:3.2\n docker image ls --format "table {{.ID}}\\t{{.Repository}}\\t{{.Tag}}"\n docker image ls --format "{{.ID}}: {{.Repository}}"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"rm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rm"}},[s._v("#")]),s._v(" rm")]),s._v(" "),n("ul",[n("li",[s._v("docker image rm [é€‰é¡¹] <é•œåƒ1> [<é•œåƒ2> ...], å…¶ä¸­ï¼Œ <é•œåƒ> å¯ä»¥æ˜¯ é•œåƒçŸ­ ID ã€ é•œåƒé•¿ ID ã€ é•œåƒå æˆ–è€… é•œåƒæ‘˜è¦")]),s._v(" "),n("li",[s._v("docker image rm 501(ä½¿ç”¨çŸ­id)")]),s._v(" "),n("li",[s._v("docker image rm centos(ä½¿ç”¨é•œåƒå)")]),s._v(" "),n("li",[s._v("ä¸ä¼šè§¦å‘çœŸæ­£åˆ é™¤çš„æƒ…å†µï¼š (1) æœ‰ä½¿ç”¨è¯¥é•œåƒçš„å®¹å™¨åœ¨è¿è¡Œ(2)æœ‰å…¶ä»–é•œåƒä¾èµ–(3)æœ‰å…¶ä»–æ ‡ç­¾æŒ‡å‘è¯¥é•œåƒ")]),s._v(" "),n("li",[s._v("åˆ é™¤è¡Œä¸ºåˆ†ä¸ºä¸¤ç§ï¼šUntagged, Deletedï¼›åœ¨æ‰§è¡Œåˆ é™¤é•œåƒå‘½ä»¤çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åˆ é™¤æŸä¸ªæ ‡ç­¾çš„é•œåƒï¼Œå¦‚æœæ²¡æœ‰æ ‡ç­¾æ‰§è¡Œè¯¥é•œåƒï¼Œæ‰ä¼šè§¦å‘deleteè¡Œä¸º")]),s._v(" "),n("li",[s._v("é…åˆls")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker image rm $(docker image ls -q redis)\ndocker image rm $(docker image ls -q -f before=mongo:3.2)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("docker image rm name:version; åˆ é™¤tag")]),s._v(" "),n("li",[s._v("åˆ é™¤é•œåƒå’Œåˆ é™¤tagæ˜¯ä¸åŒçš„")])]),s._v(" "),n("h3",{attrs:{id:"commit"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#commit"}},[s._v("#")]),s._v(" commit")]),s._v(" "),n("ul",[n("li",[s._v("ä»å®¹å™¨ä¸­åˆ›å»ºä¸€ä¸ªé•œåƒ")]),s._v(" "),n("li",[s._v("docker run --name webserver -d -p 80:80 nginx")]),s._v(" "),n("li",[s._v("docker exec -it webserver bash\n"),n("ul",[n("li",[s._v("echo '<h1>Hello, Docker!"),s._v("' > /usr/share/nginx/html/index.html")]),s._v(" "),n("li",[s._v("exit")])])]),s._v(" "),n("li",[s._v('docker commit --author "Bin Wang'),n("a",{attrs:{href:"mailto:bin.wang@capstones.cn"}},[s._v("bin.wang@capstones.cn")]),s._v('" --message "change nginx default page" webserver nginx:v-capstone')]),s._v(" "),n("li",[s._v("docker image ls")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REPOSITORY    TAG          IMAGE ID       CREATED              SIZE\nnginx         v-capstone   a89b5d375ace   About a minute ago   133MB\nnginx         latest       d1a364dc548d   3 weeks ago          133MB\nubuntu        16.04        9ff95a467e45   4 weeks ago          135MB\nhello-world   latest       d1165f221234   3 months ago         13.3kB\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[s._v("docker history nginx:v-capstone")])]),s._v(" "),n("h3",{attrs:{id:"run"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" run")]),s._v(" "),n("ul",[n("li",[s._v("æ‰€æœ‰çš„å‚æ•°éƒ½åœ¨é•œåƒidçš„å‰é¢")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -it -v /data/cuser00/var/log/redis:/logs -v /data/cuser00/var/redis:/data -v `pwd`/redis/redis.conf:/usr/local/etc/redis/redis.conf   redis:6.2.3  /bin/bash\n\næŒ‚è½½æ–‡ä»¶ï¼Œæä¾›å¤–éƒ¨åŠ¨æ€æ‰§è¡Œèƒ½åŠ›\ndocker run -it --rm  -v /data/cuser00/sand/docker/jekins/static/run.sh:/static/run.sh  php-static:1.0.0  sh /static/run.sh hotfix_wb_docker_apply \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),n("ul",[n("li",[s._v("Dockerfile ä¸­æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šå»ºç«‹ä¸€å±‚")])]),s._v(" "),n("h3",{attrs:{id:"docker-build"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-build"}},[s._v("#")]),s._v(" docker build")]),s._v(" "),n("ul",[n("li",[s._v("Docker åœ¨è¿è¡Œæ—¶åˆ†ä¸º Docker å¼•æ“ï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å®ˆæŠ¤è¿›ç¨‹ï¼‰å’Œå®¢æˆ·ç«¯å·¥å…·ã€‚Docker çš„å¼•æ“æä¾›äº†ä¸€ç»„ REST APIï¼Œè¢«ç§°ä¸º DockerRemote APIï¼Œè€Œå¦‚ dockerå‘½ä»¤è¿™æ ·çš„å®¢æˆ·ç«¯å·¥å…·ï¼Œåˆ™æ˜¯é€šè¿‡è¿™ç»„ API ä¸ Docker å¼•æ“äº¤äº’ï¼Œä»è€Œå®Œæˆå„ç§åŠŸèƒ½ã€‚å› æ­¤ï¼Œè™½ç„¶è¡¨é¢ä¸Šæˆ‘ä»¬å¥½åƒæ˜¯åœ¨æœ¬æœºæ‰§è¡Œå„ç§ dockeråŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œä¸€åˆ‡éƒ½æ˜¯ä½¿ç”¨çš„è¿œç¨‹è°ƒç”¨å½¢å¼åœ¨æœåŠ¡ç«¯ï¼ˆDockerå¼•æ“ï¼‰å®Œæˆã€‚ä¹Ÿä¸ºè¿™ç§ C/S è®¾è®¡ï¼Œè®©æˆ‘ä»¬æ“ä½œè¿œç¨‹æœåŠ¡å™¨çš„ Docker å¼•æ“å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚")]),s._v(" "),n("li",[s._v("å¦‚æœç›®å½•ä¸‹æœ‰äº›ä¸œè¥¿ç¡®å®ä¸å¸Œæœ›æ„å»ºæ—¶ä¼ ç»™ Docker å¼•æ“ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ .gitignore ä¸€æ ·çš„è¯­æ³•å†™ä¸€ä¸ª .dockerignoreï¼Œè¯¥æ–‡ä»¶æ˜¯ç”¨äºå‰”é™¤ä¸éœ€è¦ä½œä¸ºä¸Šä¸‹æ–‡ä¼ é€’ç»™ Docker å¼•æ“çš„ã€‚")]),s._v(" "),n("li",[s._v("é•œåƒæ„å»ºä¸Šä¸‹æ–‡ï¼Œåœ¨buildçš„æ—¶å€™ï¼Œå°½é‡æ˜¯ä¸€ä¸ªç©ºç›®å½•ï¼Œå› ä¸ºbuildçš„æ—¶å€™éœ€è¦å°†æŒ‡å®šçš„ä¸Šä¸‹æ–‡ç›®å½•å‘é€åˆ°dockerå¼•æ“")]),s._v(" "),n("li",[s._v("ä¾‹å­, Dockerfile")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("FROM nginx\nRUN echo '<h1>Hello, Docker!</h1>' > /usr/share/nginx/html/index.html \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("docker build -t nginx:v-cap-2(æŒ‡å®šé•œåƒå:æ ‡ç­¾) .(æŒ‡å®šä¸Šä¸‹æ–‡ç›®å½•)")]),s._v(" "),n("ul",[n("li",[s._v("ä»æ ‡å‡†è¾“å…¥ä¸­æ„å»º\ncat Dockerfile | docker build -\ndocker build - < Dockerfile\ndocker image ls ï¼Œå› ä¸ºæ²¡æœ‰æŒ‡å®šé•œåƒå:æ ‡ç­¾ï¼Œç”Ÿæˆ"),n("none",[s._v("çš„é•œåƒ")])],1)]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REPOSITORY    TAG          IMAGE ID       CREATED          SIZE\n<none>        <none>       828aa87f4921   5 seconds ago    133MB\nnginx         latest       d1a364dc548d   3 weeks ago      133MB\nubuntu        16.04        9ff95a467e45   4 weeks ago      135MB\nhello-world   latest       d1165f221234   3 months ago     13.3kB\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"directive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#directive"}},[s._v("#")]),s._v(" directive")]),s._v(" "),n("ul",[n("li",[s._v("FROM")]),s._v(" "),n("li",[s._v("RUN")]),s._v(" "),n("li",[s._v("COPYæŒ‡ä»¤å°†ä»æ„å»º"),n("strong",[s._v("ä¸Šä¸‹æ–‡ç›®å½•")]),s._v("ä¸­ <æºè·¯å¾„çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°"),n("strong",[s._v("æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„<ç›®æ ‡è·¯å¾„>")]),s._v(" ä½ç½®")]),s._v(" "),n("li",[s._v("ADD,é«˜çº§çš„COPYï¼Œä»…åœ¨éœ€è¦è§£å‹ç¼©çš„æ—¶å€™ä½¿ç”¨ADDï¼Œå…¶ä»–éƒ½ç”¨COPY")]),s._v(" "),n("li",[s._v("CMD\n"),n("ul",[n("li",[s._v("shellæ ¼å¼: CMD <å‘½ä»¤>ï¼Œæ¯”å¦‚ "),n("code",[s._v("CMD echo $HOME")])]),s._v(" "),n("li",[s._v('execæ ¼å¼: CMD ["å¯æ‰§è¡Œæ–‡ä»¶", "å‚æ•°1", "å‚æ•°2"...],æ¯”å¦‚'),n("code",[s._v('CMD [ "sh", "-c", "echo $HOME" ]')])])])]),s._v(" "),n("li",[s._v("ENTRYPOINT èµ‹äºˆäº†ä¸€ç§åŠ¨æ€å°†å¤–éƒ¨å‚æ•°ä¼ å…¥åˆ°å†…éƒ¨èƒ½åŠ›ï¼Œç›¸å½“äºdockerfileçš„mainå‡½æ•°ï¼Œè€Œmainå‡½æ•°æ˜¯å¯ä»¥æ¥æ”¶å‚æ•°çš„")]),s._v(" "),n("li",[s._v("ENV è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå³dockerfileè¿è¡ŒæœŸå¯ä»¥ä½¿ç”¨çš„å˜é‡")]),s._v(" "),n("li",[s._v("ARG å‚æ•°")]),s._v(" "),n("li",[s._v("VOLUME å®šä¹‰åŒ¿åå·ï¼Œ æŒ‡å®šå¤–éƒ¨æŒ‚è½½çš„ç›®å½•ï¼Œä¿è¯å®¹å™¨å­˜å‚¨å±‚çš„æ— çŠ¶æ€åŒ– docker run -d -v mydata:/data xxxx,å¯ä»¥é€šè¿‡å‚æ•°è¦†ç›–åŸæ¥çš„VOLUMEè®¾ç½®")]),s._v(" "),n("li",[s._v("EXPOSE å£°æ˜ç½‘ç»œç«¯å£")]),s._v(" "),n("li",[s._v("WORKDIR æŒ‡å®šå·¥ä½œç›®å½•")]),s._v(" "),n("li",[s._v("USER æŒ‡å®šå½“å‰ç”¨æˆ·,å¦‚æœä»¥ root æ‰§è¡Œçš„è„šæœ¬ï¼Œåœ¨æ‰§è¡ŒæœŸé—´å¸Œæœ›æ”¹å˜èº«ä»½ï¼Œæ¯”å¦‚å¸Œæœ›ä»¥æŸä¸ªå·²ç»å»ºç«‹å¥½çš„ç”¨æˆ·æ¥è¿è¡ŒæŸä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¸è¦ä½¿ç”¨ su æˆ–è€… sudo ï¼Œè¿™äº›éƒ½éœ€è¦æ¯”è¾ƒéº»çƒ¦çš„é…ç½®ï¼Œè€Œä¸”åœ¨ TTY ç¼ºå¤±çš„ç¯å¢ƒä¸‹ç»å¸¸å‡ºé”™ã€‚å»ºè®®ä½¿ç”¨ gosuã€‚")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# å»ºç«‹ redis ç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨ gosu æ¢å¦ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œå‘½ä»¤\nRUN groupadd -r redis && useradd -r -g redis redis\n# ä¸‹è½½ gosu\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v('RUN wget -O /usr/local/bin/gosu "https://github.com/tianon/gosu/releases/download/1.7/\ngosu-amd64" '),n("br"),s._v("\n&& chmod +x /usr/local/bin/gosu "),n("br"),s._v("\n&& gosu nobody true")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('# è®¾ç½® CMDï¼Œå¹¶ä»¥å¦å¤–çš„ç”¨æˆ·æ‰§è¡Œ\nCMD [ "exec", "gosu", "redis", "redis-server" ]\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("HEALTHCHECKå¥åº·æ£€æŸ¥")]),s._v(" "),n("li",[s._v("ONBUILD, ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡ä»¤ï¼Œå®ƒåé¢è·Ÿçš„æ˜¯å…¶å®ƒæŒ‡ä»¤ï¼Œæ¯”å¦‚ RUN , COPY ç­‰ï¼Œè€Œè¿™äº›æŒ‡ä»¤ï¼Œåœ¨å½“å‰é•œåƒæ„å»ºæ—¶å¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚åªæœ‰å½“ä»¥å½“å‰é•œåƒä¸ºåŸºç¡€é•œåƒï¼Œå»æ„å»ºä¸‹ä¸€çº§é•œåƒçš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œã€‚")]),s._v(" "),n("li",[s._v("å¤šé˜¶æ®µæ„å»º")])]),s._v(" "),n("h2",{attrs:{id:"dockerå®¹å™¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerå®¹å™¨"}},[s._v("#")]),s._v(" Dockerå®¹å™¨")]),s._v(" "),n("ul",[n("li",[s._v("Imageé•œåƒå’Œå®¹å™¨Containerçš„å…³ç³»ï¼Œå°±åƒé¢å‘å¯¹è±¡çš„ç±»å’Œå®ä¾‹çš„å…³ç³»ã€‚é•œåƒæ˜¯é™æ€çš„ï¼Œå®¹å™¨åˆ™æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“")]),s._v(" "),n("li",[s._v("Docker ä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨ä¸­çš„åº”ç”¨éƒ½åº”è¯¥ä»¥å‰å°æ‰§è¡Œï¼Œè€Œä¸æ˜¯åƒè™šæ‹Ÿæœºã€ç‰©ç†æœºé‡Œé¢é‚£æ ·ï¼Œç”¨ upstart/systemd å»å¯åŠ¨åå°æœåŠ¡ï¼Œå®¹å™¨å†…æ²¡æœ‰åå°æœåŠ¡çš„æ¦‚å¿µã€‚")])]),s._v(" "),n("h3",{attrs:{id:"list-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#list-2"}},[s._v("#")]),s._v(" list")]),s._v(" "),n("ul",[n("li",[s._v("docker container ls")]),s._v(" "),n("li",[s._v("docker container ls -a")])]),s._v(" "),n("h3",{attrs:{id:"run-æ–°å»ºå¹¶å¯åŠ¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run-æ–°å»ºå¹¶å¯åŠ¨"}},[s._v("#")]),s._v(" run æ–°å»ºå¹¶å¯åŠ¨")]),s._v(" "),n("ul",[n("li",[s._v("docker run ubuntu:14.04 /bin/echo 'Hello world'")]),s._v(" "),n("li",[s._v("docker run -t -i ubuntu:14.04 /bin/bash, -t åˆ†é…ä¼ªç»ˆç«¯, -i åˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ï¼Œè¿‡ç¨‹å¦‚ä¸‹:")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»å…¬æœ‰ä»“åº“ä¸‹è½½\nåˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨\nåˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚\nä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å»\nä»åœ°å€æ± é…ç½®ä¸€ä¸ª ip åœ°å€ç»™å®¹å™¨\næ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åº\næ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"start"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#start"}},[s._v("#")]),s._v(" start")]),s._v(" "),n("ul",[n("li",[s._v("å°†ä¸€ä¸ªå·²ç»ç»ˆæ­¢çš„å®¹å™¨å¯åŠ¨è¿è¡Œ")])]),s._v(" "),n("h3",{attrs:{id:"stop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#stop"}},[s._v("#")]),s._v(" stop")]),s._v(" "),n("h3",{attrs:{id:"restart"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#restart"}},[s._v("#")]),s._v(" restart")]),s._v(" "),n("h3",{attrs:{id:"åå°è¿è¡Œ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åå°è¿è¡Œ"}},[s._v("#")]),s._v(" åå°è¿è¡Œ")]),s._v(" "),n("ul",[n("li",[s._v("-d åŠ ä¸Š-då‚æ•°")]),s._v(" "),n("li",[s._v("éœ€è¦è®© Docker åœ¨åå°è¿è¡Œè€Œä¸æ˜¯ç›´æ¥æŠŠæ‰§è¡Œå‘½ä»¤çš„ç»“æœè¾“å‡ºåœ¨å½“å‰å®¿ä¸»æœºä¸‹")]),s._v(" "),n("li",[s._v('docker run -d ubuntu:17.10 /bin/sh -c "while true; do echo hello world; sleep 1; done"ï¼Œå¯ä»¥ä½¿ç”¨docker container logsæŸ¥çœ‹')])]),s._v(" "),n("h3",{attrs:{id:"sttach"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sttach"}},[s._v("#")]),s._v(" sttach")]),s._v(" "),n("h3",{attrs:{id:"exec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exec"}},[s._v("#")]),s._v(" exec")]),s._v(" "),n("ul",[n("li",[s._v("æ¨èä½¿ç”¨")])]),s._v(" "),n("h3",{attrs:{id:"import-export"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#import-export"}},[s._v("#")]),s._v(" import export")]),s._v(" "),n("ul",[n("li",[s._v("å¯¼å…¥ å¯¼å‡ºå®¹å™¨å¿«ç…§")])]),s._v(" "),n("h3",{attrs:{id:"rm-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rm-2"}},[s._v("#")]),s._v(" rm")]),s._v(" "),n("ul",[n("li",[s._v("åˆ é™¤å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨")]),s._v(" "),n("li",[s._v("docker container rm f9af5ee2bbc9 -f å¼ºåˆ¶åˆ é™¤")])]),s._v(" "),n("h3",{attrs:{id:"prune"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#prune"}},[s._v("#")]),s._v(" prune")]),s._v(" "),n("ul",[n("li",[s._v("docker container prune ï¼Œæ¸…ç†å·²ç»ç»ˆæ­¢çš„æ‰€æœ‰å®¹å™¨")])]),s._v(" "),n("h2",{attrs:{id:"repository"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#repository"}},[s._v("#")]),s._v(" Repository")]),s._v(" "),n("ul",[n("li",[s._v("Registry æ˜¯æœåŠ¡å™¨ï¼Œæ¯ä¸ªæœåŠ¡å™¨ä¸‹é¢å¯ä»¥æœ‰å¤šä¸ªä»“åº“ï¼›è€Œæ¯ä¸ªä»“åº“ä¸‹é¢å¯ä»¥æœ‰å¤šä¸ªé•œåƒ")]),s._v(" "),n("li",[s._v("docker search centos")])]),s._v(" "),n("h2",{attrs:{id:"docker-registry"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-registry"}},[s._v("#")]),s._v(" Docker Registry")]),s._v(" "),n("ul",[n("li",[s._v("å­˜å‚¨ã€åˆ†å‘é•œåƒçš„æœåŠ¡")])]),s._v(" "),n("h2",{attrs:{id:"æ•°æ®ç®¡ç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®ç®¡ç†"}},[s._v("#")]),s._v(" æ•°æ®ç®¡ç†")]),s._v(" "),n("h3",{attrs:{id:"ä½¿ç”¨æ•°æ®å·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨æ•°æ®å·"}},[s._v("#")]),s._v(" ä½¿ç”¨æ•°æ®å·")]),s._v(" "),n("ul",[n("li",[s._v("docker volume create my-vol")]),s._v(" "),n("li",[s._v("docker volume ls")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("DRIVER    VOLUME NAME\nlocal     my-vol\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("docker volume inspect my-vol")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('[\n    {\n        "CreatedAt": "2021-06-17T17:13:26+08:00",\n        "Driver": "local",\n        "Labels": {},\n        "Mountpoint": "/var/lib/docker/volumes/my-vol/_data",\n        "Name": "my-vol",\n        "Options": {},\n        "Scope": "local"\n    }\n]\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("ul",[n("li",[s._v("å¯åŠ¨ä¸€ä¸ªæŒ‚è½½æ•°æ®å·çš„å®¹å™¨")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -d -P \\\n    --name web \\\n    # -v my-vol:/wepapp \\\n    --mount source=my-vol,target=/webapp \\\n    training/webapp \\\n    python app.py\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("docker inspect web")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('"Mounts": [\n    {\n        "Type": "volume",\n        "Name": "my-vol",\n        "Source": "/var/lib/docker/volumes/my-vol/_data",\n        "Destination": "/app",\n        "Driver": "local",\n        "Mode": "",\n        "RW": true,\n        "Propagation": ""\n    }\n],\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[s._v("docker volume rm my-vol")]),s._v(" "),n("li",[s._v("docker volume prune")]),s._v(" "),n("li",[s._v("docker system prune ä¸€é”®æ¸…ç†æ‰€æœ‰ä¸ç”¨çš„å·ã€é•œåƒç­‰")])]),s._v(" "),n("h3",{attrs:{id:"æŒ‚è½½ä¸»æœºç›®å½•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æŒ‚è½½ä¸»æœºç›®å½•"}},[s._v("#")]),s._v(" æŒ‚è½½ä¸»æœºç›®å½•")]),s._v(" "),n("ul",[n("li",[s._v("é•œåƒä½¿ç”¨çš„æ˜¯åˆ†å±‚å­˜å‚¨ï¼Œå®¹å™¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ä»¥é•œåƒä¸ºåŸºç¡€å±‚ï¼Œåœ¨å…¶ä¸Šåˆ›å»ºä¸€ä¸ªå½“å‰å®¹å™¨çš„å­˜å‚¨å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç§°è¿™ä¸ªä¸ºå®¹å™¨è¿è¡Œæ—¶è¯»å†™è€Œå‡†å¤‡çš„å­˜å‚¨å±‚ä¸ºå®¹å™¨å­˜å‚¨å±‚ã€‚"),n("strong",[s._v("å®¹å™¨å­˜å‚¨å±‚çš„ç”Ÿå­˜å‘¨æœŸå’Œå®¹å™¨ä¸€æ ·ï¼Œå®¹å™¨æ¶ˆäº¡æ—¶ï¼Œå®¹å™¨å­˜å‚¨å±‚ä¹Ÿéšä¹‹æ¶ˆäº¡")])]),s._v(" "),n("li",[s._v("æŒ‚è½½ç›®å½•ä½¿ç”¨çš„éƒ½æ˜¯rootæƒé™ï¼Œä½†æ˜¯æ‰§è¡Œä½¿ç”¨çš„å…¶ä»–ç”¨æˆ·")]),s._v(" "),n("li",[s._v("å‘½ä»¤")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -d -P \\\n    --name web \\\n    # -v /src/webapp:/opt/webapp \\\n    --mount type=bind,source=/src/webapp,target=/opt/webapp \\\n    training/webapp \\\n    python app.py\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("æ ¼å¼2")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -d -P \\\n    --name web \\\n    # -v /src/webapp:/opt/webapp:ro \\\n    --mount type=bind,source=/src/webapp,target=/opt/webapp,readonly \\\n    training/webapp \\\n    python app.py\n\næŒ‚è½½å¤šä¸ªç›®å½•ä½¿ç”¨å¤šä¸ª-vå‚æ•°\ndocker run -it -v /data/cuser00/var/log/redis:/logs -v /data/cuser00/var/redis:/data -v `pwd`/redis/redis.conf:/usr/local/etc/redis/redis.conf   redis:6.2.3  /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("docker inspect web")]),s._v(" "),n("li",[s._v("æŒ‚è½½å•ä¸ªæ–‡ä»¶")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run --rm -it \\\n    --mount type=bind,source=$HOME/.bash_history,target=/root/.bash_history \\\n    ubuntu:17.10 \\\n    bash\nroot@2affd44b4667:/# history\n1 ls\n2 diskutil list\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[s._v("æŒ‚è½½ç›®å½•")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -it -v /data/cuser00/var/nginx/:/data nginx:1.18 /bin/bash\næ³¨æ„: å°†æ‰€æœ‰çš„é…ç½®é¡¹å†™åœ¨å‰éƒ¨ï¼Œåé¢æ˜¯é•œåƒå’Œå‘½ä»¤\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"ä½¿ç”¨ç½‘ç»œ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨ç½‘ç»œ"}},[s._v("#")]),s._v(" ä½¿ç”¨ç½‘ç»œ")]),s._v(" "),n("ul",[n("li",[s._v("ä½¿ç”¨-Pï¼Œ Docker ä¼šéšæœºæ˜ å°„ä¸€ä¸ª 49000~49900 çš„ç«¯å£åˆ°å†…éƒ¨å®¹å™¨å¼€æ”¾çš„ç½‘ç»œç«¯å£")]),s._v(" "),n("li",[s._v("ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort, ä¾‹å­")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("    docker run -d -p 5000:5000 training/webapp python app.py\n    docker run -d -p 127.0.0.1::5000 training/webapp python app.py\n    docker run -d -p 127.0.0.1:5000:5000 training/webapp python app.py\n    docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py\n    docker run -d \\\n        -p 5000:5000 \\\n        -p 3000:80 \\\n        training/webapp \\\n        python app.py\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("docker port nostalgic_morse 5000")]),s._v(" "),n("li",[s._v("dockeråœ¨å®‰è£…åä¼šé»˜è®¤ç”Ÿæˆä¸‰ç§ç½‘ç»œï¼Œnoneã€bridgeåŠhost.")]),s._v(" "),n("li",[s._v("æŸ¥çœ‹ç½‘ç»œä¿¡æ¯ docker network ls")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("NETWORK ID     NAME      DRIVER    SCOPE\n1d2e9d7c9bff   bridge    bridge    local\n349bd72081d1   host      host      local\n2f60f451a8cc   none      null      local\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"compose"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#compose"}},[s._v("#")]),s._v(" compose")]),s._v(" "),n("h3",{attrs:{id:"å®‰è£…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…"}},[s._v("#")]),s._v(" å®‰è£…")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\n$ sudo chmod +x /usr/local/bin/docker-compose\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sudo pip install -U docker-compose\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"build"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" build")]),s._v(" "),n("ul",[n("li",[s._v("buildå‘½ä»¤ï¼Œåªæ„å»º")])]),s._v(" "),n("h3",{attrs:{id:"run-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run-2"}},[s._v("#")]),s._v(" run")]),s._v(" "),n("ul",[n("li",[s._v("docker-compose run --rm redis")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("--rm è¿è¡Œç»“æŸè‡ªåŠ¨åˆ é™¤å®¹å™¨\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"up"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#up"}},[s._v("#")]),s._v(" up")]),s._v(" "),n("ul",[n("li",[s._v("docker-compose up -d(ç”Ÿäº§å»ºè®®ä½¿ç”¨ï¼Œè°ƒè¯•ç¯å¢ƒä¸­ä¸ä½¿ç”¨)")])]),s._v(" "),n("h2",{attrs:{id:"ç›‘æ§-ç³»ç»Ÿ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘æ§-ç³»ç»Ÿ"}},[s._v("#")]),s._v(" ç›‘æ§&ç³»ç»Ÿ")]),s._v(" "),n("ul",[n("li",[s._v("docker stats")]),s._v(" "),n("li",[s._v("docker ps = docker container ls")]),s._v(" "),n("li",[s._v("docker system prune -a")]),s._v(" "),n("li",[s._v("docker system df")]),s._v(" "),n("li",[s._v("docker info")])]),s._v(" "),n("h2",{attrs:{id:"åº”ç”¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åº”ç”¨"}},[s._v("#")]),s._v(" åº”ç”¨")]),s._v(" "),n("ul",[n("li",[s._v("docker pull php:7.2-fpm")]),s._v(" "),n("li",[s._v("docker build . -f php-docker-file -t php:v-h5-game")])]),s._v(" "),n("h2",{attrs:{id:"ç›®å½•æƒé™é—®é¢˜"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç›®å½•æƒé™é—®é¢˜"}},[s._v("#")]),s._v(" ç›®å½•æƒé™é—®é¢˜")]),s._v(" "),n("ul",[n("li",[s._v("ç›®å½•éƒ½ä¸å¿…æå‰åˆ›å»º")]),s._v(" "),n("li",[s._v("é»˜è®¤éƒ½æ˜¯rootæƒé™,å› ä¸ºdockerä½¿ç”¨äº†rootå¯åŠ¨")])]),s._v(" "),n("h2",{attrs:{id:"ç”¨æˆ·é—®é¢˜"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æˆ·é—®é¢˜"}},[s._v("#")]),s._v(" ç”¨æˆ·é—®é¢˜")]),s._v(" "),n("ul",[n("li",[s._v("ä½¿ç”¨æœªé¢„è®¾çš„ç”¨æˆ·ä½¿ç”¨docker")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ä½¿ç”¨docker exec -it 69f8942e7621 /bin/bash è¿›å…¥\nI have no name!@69f8942e7621:/data$ id -g \n1003\nI have no name!@69f8942e7621:/data$ id -u \n1004\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[s._v("sudo chown -R 1004:1003 redisï¼Œ docker-composeçš„userä¸è¯¥ç”¨æˆ·ä¸€ç›´æ–¹èƒ½æœ‰æƒé™")])]),s._v(" "),n("h2",{attrs:{id:"ç”¨æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æ³•"}},[s._v("#")]),s._v(" ç”¨æ³•")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker run -it -u 1004:1003 -v /etc/localtime:/etc/localtime:ro -v /data/cuser00/var/log/redis:/logs -v /data/cuser00/var/redis:/data -v `pwd`/redis/redis.conf:/usr/local/etc/redis/redis.conf   redis:6.2.3  redis-server /usr/local/etc/redis/redis.conf  \né‡å¯æ‰€æœ‰composeç®¡ç†çš„æ‰€æœ‰å®¹å™¨ï¼ˆåªé‡å¯å·²ç»å¯åŠ¨çš„éƒ¨åˆ†ï¼‰\ndocker-compose  restart\né‡å¯redis\ndocker-compose  restart  redis\ndocker-compose  stop redis  \ndocker-compose  start redis\ndocker-compose up redis  å‰å°å¯åŠ¨ï¼Œçœ‹åˆ°è°ƒè¯•ä¿¡æ¯\ndocker-compose up -d  redis åå°å¯åŠ¨ï¼Œä¸startç±»ä¼¼(ä½†æ˜¯startæ˜¯é’ˆå¯¹å®¹å™¨çš„)\ndocker-compose run/up -d redis\nrestartçš„æ—¶å€™ä¸ä¼šé‡æ–°ç”Ÿæˆæ–°çš„å®¹å™¨ï¼Œå³ä½¿ç”¨æ–°çš„docker-composeçš„é…ç½®ï¼›å¦‚æœéœ€è¦æ›´æ–°docker-composeä¸­çš„é…ç½®ä¿¡æ¯ï¼Œéœ€è¦åˆ é™¤å®¹å™¨é‡æ–°ç”Ÿæˆ\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[s._v("ä½¿ç”¨érootç”¨æˆ·è¿è¡Œ CURRENT_UID=$(id -u)ğŸ˜’(id -g) docker-compose up -d redis")]),s._v(" "),n("li",[s._v("docker ps")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker ps -q\n    f0be9144d264\n    44dc5b9702c4\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("åœæ­¢æ‰€æœ‰çš„å®¹å™¨ docker stop $(docker ps -aq)")]),s._v(" "),n("li",[s._v("åˆ é™¤æ‰€æœ‰çš„å®¹å™¨ docker rm $(docker ps -aq)")]),s._v(" "),n("li",[s._v("åˆ é™¤æ‰€æœ‰çš„é•œåƒ docker rmi $(docker images -q)")]),s._v(" "),n("li",[s._v("ä¸€æ¡å‘½ä»¤å®ç°åœç”¨å¹¶åˆ é™¤å®¹å™¨ docker stop $(docker ps -q) & docker rm $(docker ps -aq)")]),s._v(" "),n("li",[s._v("docker login --username=wang70bin@163.com registry.cn-hangzhou.aliyuncs.com")]),s._v(" "),n("li",[s._v("docker login pull push")])]),s._v(" "),n("h2",{attrs:{id:"è‡ªç”±å‘æŒ¥command"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªç”±å‘æŒ¥command"}},[s._v("#")]),s._v(" è‡ªç”±å‘æŒ¥command")]),s._v(" "),n("ul",[n("li",[s._v("ä¸¤ç§æ ¼å¼å½¢å¼")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("command: php /code/workerman/start.php start\næˆ–è€…åˆ†è¡Œ\ncommand: \n    - php \n    - /code/workerman/start.php \n    - start\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("ä¾‹å­ docker run -it -p 9999:9999 -p 9997:9997  -v /data/cuser00/www/h5/Lottery/:/code -v /data/cuser00/var/log/workerman:/logs  php-wm:1.0 php /code/workerman/start.php start")]),s._v(" "),n("li",[s._v("CURRENT_UID=0:0 docker-compose run --rm -p 9999:9999 -p 9997:9997 workerman (ä¸æŒ‡å®športï¼Œç«¯å£ä¸ä¼šå¯¹å¤–èµ·æ•ˆ)")]),s._v(" "),n("li",[s._v('docker run --name static_builder(æŒ‡å®šå®¹å™¨åå­—) -d  -v /data/cuser00/sand/docker/jekins/static/run.sh:/static/run.sh  php-static:1.0.0 /bin/sh -c "while true; do echo hello world; sleep 1; done" è®©æŸä¸ªé…ç½®å‹çš„å®¹å™¨ä¸€ç›´è¿è¡Œ')]),s._v(" "),n("li",[s._v("docker exec -it static_builder /bin/bash /static/run.sh hotfix_wb_docker_apply_v1 å®¹å™¨æ‰§è¡ŒæŸä¸ªå‘½ä»¤")]),s._v(" "),n("li",[s._v("å¯ä»¥ä»æŸä¸€ä¸ªä¸­é—´å±‚è¿›å…¥ï¼Œæ¯”å¦‚ docker run -it "),n("strong",[s._v("91060a9c19f0")]),s._v(" /bin/bash")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Step 1/7 : FROM php:7.2-fpm\n ---\x3e 28f52b60203d\nStep 2/7 : RUN sed -i s@/deb.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.list\n ---\x3e Using cache\n ---\x3e 10813dc262a8\nStep 3/7 : RUN apt-get update\n ---\x3e Using cache\n ---\x3e ff4bc648f240\nStep 4/7 : RUN apt-get install -y software-properties-common\n ---\x3e Using cache\n ---\x3e de9eb509f656\nStep 5/7 : RUN add-apt-repository ppa:deadsnakes/ppa\n ---\x3e Using cache\n ---\x3e 91060a9c19f0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"å¤´å¤§"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¤´å¤§"}},[s._v("#")]),s._v(" å¤´å¤§")]),s._v(" "),n("ul",[n("li",[s._v('Primary script unknown" while reading response header from upstreamï¼ŒåŸæ¥æ˜¯æ—§çš„php-fpmæ²¡æœ‰å…³é—­æˆ–è€…åˆè¢«æ‹‰èµ·ï¼Œå¯¼è‡´è½¬åˆ°é‚£ä¸ªç«¯å£å»äº†;è€Œdockeræ˜¯ä¸ä¼šæ£€æµ‹ç«¯å£çš„åˆæ³•æ€§çš„')]),s._v(" "),n("li")]),s._v(" "),n("h2",{attrs:{id:"å®è·µå»ºè®®"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®è·µå»ºè®®"}},[s._v("#")]),s._v(" å®è·µå»ºè®®")]),s._v(" "),n("ul",[n("li",[s._v("å®¹å™¨ä¸åº”è¯¥å‘å…¶å­˜å‚¨å±‚å†…å†™å…¥ä»»ä½•æ•°æ®ï¼Œå®¹å™¨å­˜å‚¨å±‚è¦ä¿æŒæ— çŠ¶æ€åŒ–ã€‚æ‰€æœ‰çš„æ–‡ä»¶å†™å…¥æ“ä½œï¼Œéƒ½åº”è¯¥ä½¿ç”¨æ•°æ®å·(volumen)ã€æˆ–è€…ç»‘å®šå®¿ä¸»ç›®å½•ï¼Œåœ¨è¿™äº›ä½ç½®çš„è¯»å†™ä¼šè·³è¿‡å®¹å™¨å­˜å‚¨å±‚ï¼Œç›´æ¥å¯¹å®¿ä¸»(æˆ–è€…ç½‘ç»œå­˜å‚¨)å‘ç”Ÿè¯»å†™ï¼Œå…¶æ€§èƒ½å’Œç¨³å®šæ€§æ›´é«˜ã€‚ï¼ˆå› ä¸ºå®¹å™¨å­˜å‚¨å±‚ä¼šéšç€å®¹å™¨çš„æ¶ˆäº¡è€Œæ¶ˆäº¡ï¼‰")]),s._v(" "),n("li",[s._v("æ‰€ä»¥å¯¹äº CentOS/RHEL çš„ç”¨æˆ·æ¥è¯´ï¼Œåœ¨æ²¡æœ‰åŠæ³•ä½¿ç”¨ UnionFSçš„æƒ…å†µä¸‹ï¼Œä¸€å®šè¦é…ç½®direct-lvm ç»™ devicemapperï¼Œæ— è®ºæ˜¯ä¸ºäº†æ€§èƒ½ã€ç¨³å®šæ€§è¿˜æ˜¯ç©ºé—´åˆ©ç”¨ç‡ã€‚")]),s._v(" "),n("li",[s._v("ä½¿ç”¨ docker commit å‘½ä»¤è™½ç„¶å¯ä»¥æ¯”è¾ƒç›´è§‚çš„å¸®åŠ©ç†è§£é•œåƒåˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µï¼Œä½†æ˜¯"),n("strong",[s._v("å®é™…ç¯å¢ƒä¸­å¹¶ä¸ä¼šè¿™æ ·ä½¿ç”¨")]),s._v("ã€‚")]),s._v(" "),n("li",[s._v("å¾ˆå¤šäººåˆå­¦ Docker åˆ¶ä½œå‡ºäº†å¾ˆè‡ƒè‚¿çš„é•œåƒçš„åŸå› ä¹‹ä¸€ï¼Œå°±æ˜¯å¿˜è®°äº†æ¯ä¸€å±‚æ„å»ºçš„æœ€åä¸€å®šè¦æ¸…ç†æ‰æ— å…³æ–‡ä»¶ã€‚")]),s._v(" "),n("li",[s._v("å®¹å™¨ç›®å½•ä¸å¯ä»¥ä¸ºç›¸å¯¹è·¯å¾„")]),s._v(" "),n("li",[s._v("å®¿ä¸»æœºç›®å½•å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆ")]),s._v(" "),n("li",[s._v("*******************æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æŒ‚è½½ç›®å½•éƒ½éœ€è¦æå‰è®¾ç½®æƒé™å‘¢?")]),s._v(" "),n("li",[s._v("portåªæ˜¯åšäº†ä¸€å±‚ç«¯å£è½¬å‘ï¼Œéœ€è¦ä¸¤é¢matchæ‰èƒ½å¤Ÿèµ·æ•ˆ")]),s._v(" "),n("li",[s._v("dockerçš„ä¸¤ç§æœ€é¡¶å±‚çŠ¶æ€ï¼šéœ€è¦æŒ‡å®šå‘½ä»¤ï¼Œä¸éœ€è¦æŒ‡å®šå‘½ä»¤ ç›´æ¥å¯ä»¥è¿è¡Œ")]),s._v(" "),n("li",[s._v("dockeråœæ­¢æ€è¿›å»ï¼Œrun  -it imageId /bin/bash,è¿è¡Œæ€è¿›å» exec -it containerId /bin/bash")]),s._v(" "),n("li",[n("strong",[s._v("dockeré‡Œé¢çš„æ‰§è¡Œè¿›ç¨‹çš„ç”¨æˆ·æ˜¯é…ç½®æ–‡ä»¶å†³å®šçš„")])]),s._v(" "),n("li",[s._v("æƒé™ï¼š å¯åŠ¨ç”¨æˆ·(rootã€dockerGroup), æ“ä½œç”¨æˆ·(é…ç½®æ–‡ä»¶æŒ‡å®š)ï¼Œç”Ÿæˆæ–‡ä»¶ç”¨æˆ·(ä¸€å®šä½¿ç”¨rootæƒé™ç”Ÿæˆï¼Œè¿™æ—¶å€™å¦‚æœæŒ‡å®šæŸä¸ªç”¨æˆ·æ“ä½œç›®å½•ä¼šäº§ç”Ÿé—®é¢˜)")]),s._v(" "),n("li",[s._v("polkitd inputé—®é¢˜ï¼š dockerå’Œhostçš„æƒé™æ˜¯é uid:gidæ¥ä¼ é€’çš„ï¼Œ"),n("strong",[s._v("å½“dockeré‡Œé¢ä½¿ç”¨mysqlæˆ–è€…æ•°æ®åº“çš„ç”¨æˆ·ååˆ›å»ºæ–‡ä»¶çš„æ—¶å€™ï¼Œhostæ˜¾ç¤ºçš„æ—¶å€™å¯èƒ½å¯¹åº”åˆ°å…¶ä»–çš„ç”¨æˆ·åå’Œç»„")])]),s._v(" "),n("li",[s._v("æ•°æ®åº“åˆ›å»ºçš„æ—¶å€™å¿…é¡»æå‰åˆ›å»ºç›®å½•å¹¶ä¸”ç»™äºˆ777çš„æƒé™")]),s._v(" "),n("li",[s._v("ps aux å¯ä»¥çœ‹åˆ°dockerä¸­å¯åŠ¨çš„è¿›ç¨‹")]),s._v(" "),n("li",[s._v("dockerd --debug å¯ä»¥çœ‹åˆ°ä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼Œæ¯”å¦‚å¯åŠ¨å¤±è´¥ç­‰")]),s._v(" "),n("li",[s._v("docker æ˜¯ä¸€ç§è£…ç½®ï¼Œå°†å¤æ‚çš„åŠŸèƒ½æ¨¡å¼åŒ–ï¼Œç±»ä¼¼äºä¸€ä¸ªåŠŸèƒ½è„šæœ¬")]),s._v(" "),n("li",[s._v("Dockeræ„å»ºè¿‡ç¨‹æ˜¯"),n("strong",[s._v("å®Œå…¨éäº¤äº’çš„")])]),s._v(" "),n("li",[s._v("é™¤äº†dockerfileï¼Œè¿˜å¯ä»¥ä»/bash/bashä¸­è¿›å…¥åˆ°å®¹å™¨ä¸­ï¼Œç„¶åä¸€é˜µæ“ä½œåï¼Œå†å°†ä¿®æ”¹åçš„å®¹å™¨æäº¤åˆ°é•œåƒä¸­")]),s._v(" "),n("li",[s._v("-it ç›¸å½“äºä»dockerä¸­å¼€å¯äº†ä¸€ä¸ªterminal")]),s._v(" "),n("li",[s._v("dockerçš„å®˜æ–¹é•œåƒå¤§å¤šåŸºäºdebianï¼Œå› ä¸ºå®ƒæ˜¯è½»é‡çš„å‘è¡Œç‰ˆã€‚ç›®å‰ Docker å®˜æ–¹å·²å¼€å§‹æ¨èä½¿ç”¨ Alpine æ›¿ä»£ä¹‹å‰çš„ Ubuntu åšä¸ºåŸºç¡€é•œåƒç¯å¢ƒ")]),s._v(" "),n("li",[s._v("éƒ¨ç½²ä¸ºå¯æŸ¥çœ‹ç¯å¢ƒ: apt-get update && apt-get install procps && apt-get install net-tools && apt-get install vim")]),s._v(" "),n("li",[s._v("ä½¿ç”¨é˜¿é‡Œäº‘çš„è½¯ä»¶ä»“åº“ sed -i s@/deb.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.list")]),s._v(" "),n("li",[s._v("apt-get install telnet")]),s._v(" "),n("li",[s._v("vimä¹±ç ï¼Œç¼–è¾‘~/.vimrc,æ·»åŠ ä»¥ä¸‹å†…å®¹")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("set nocompatible\nfiletype off\n\nsyntax on\nset tabstop=4\n\nset fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936\nset termencoding=utf-8\nset encoding=utf-8\n~                  \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);