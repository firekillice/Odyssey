(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{647:function(s,a,t){"use strict";t.r(a);var n=t(26),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"iptables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iptables"}},[s._v("#")]),s._v(" iptables")]),s._v(" "),t("h3",{attrs:{id:"规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#规则"}},[s._v("#")]),s._v(" 规则")]),s._v(" "),t("ul",[t("li",[s._v("iptables –t table –A/D/R/I/NX chain match –j action")]),s._v(" "),t("li",[s._v("action: ACCEPT, DROP, REDIRECT, REJECT, SNAT(Source Network Address Translation，源地址转换，源映射), DNAT(Destination Network Address Translation,目的地址转换， 目的映射), MASQUERADE(IP伪装, 算是snat中的一种特例，可以实现自动化的snat), LOG日志")]),s._v(" "),t("li",[s._v("table:")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("* filter, 负责过滤数据包，包括的规则链有，input，output和forward；\n* nat, 涉及到网络地址转换，包括的规则链有，prerouting，postrouting和output；\n* mangle, 主要应用在修改数据包内容上，用来做流量整形的，默认的规则链有：INPUT，OUTPUT，NAT，POSTROUTING,PREROUTING\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[s._v("参数")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("-A 向规则链中添加一条规则，默认被添加到末尾\n-T指定要操作的表，默认是filter\n-D从规则链中删除规则，可以指定序号或者匹配的规则来删除\n-R进行规则替换\n-I插入一条规则，默认被插入到首部\n-F清空所选的链，重启后恢复\n-N新建用户自定义的规则链\n-X删除用户自定义的规则链\n-p用来指定协议可以是tcp，udp，icmp等也可以是数字的协议号，\n-s指定源地址\n-d指定目的地址\n-m匹配, mac, limit, state,\n-i进入接口\n-o流出接口\n-j采取的动作，accept，drop，snat，dnat，masquerade\n--sport源端口\n--dport目的端口，端口必须和协议一起来配合使用\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"ops-commands"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ops-commands"}},[s._v("#")]),s._v(" ops commands")]),s._v(" "),t("ul",[t("li",[s._v("iptables -t filter -A INPUT -s 123.11.24.0/24 -j DROP，在filter表的Input链上添加规则，来自123.456.789.0/24（255.255.255.0）的数据包全部丢弃")]),s._v(" "),t("li",[s._v("iptables -A INPUT -s 192.168.0.3 -p tcp –d port 22 -j ACCEPT，全部接收来自192.168.0.3的tcp数据包到本地22端口的数据包；（限制ssh连接的地址范围）")]),s._v(" "),t("li",[s._v("iptables -t nat -A PREROUTING -p tcp -d 216.94.87.37 --dport 2121 -j DNAT --to-destination 192.168.1.47:21")]),s._v(" "),t("li",[s._v("iptables -t nat -A POSTROUTING -p tcp -s 192.168.100.125 --sport 21 -j SNAT --to-source 216.94.87.37:2121")]),s._v(" "),t("li",[s._v("iptables -t nat -A OUTPUT -d 192.168.1.21 -j DNAT --to 10.221.152.156 将去往192.168.1.21 的数据包修改为去往10.221.152.156 ，其实就是强制修改IP地址。")])]),s._v(" "),t("h3",{attrs:{id:"normal-command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#normal-command"}},[s._v("#")]),s._v(" normal command")]),s._v(" "),t("ul",[t("li",[s._v("iptables -nvL --line-numbers：查看fliter表中规则的顺序")]),s._v(" "),t("li",[s._v("iptables-save > /etc/sysconfig/iptables 保存防火墙")]),s._v(" "),t("li",[s._v("iptables-restore < /etc/sysconfig/iptables")])]),s._v(" "),t("h3",{attrs:{id:"firewalld对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#firewalld对比"}},[s._v("#")]),s._v(" firewalld对比")]),s._v(" "),t("ul",[t("li",[s._v("centos7默认使用了firewalld，放弃了iptables")]),s._v(" "),t("li",[s._v("firewalld可以认为是iptables的升级版，功能更强大，更易用")]),s._v(" "),t("li",[s._v("firewalld调用iptables的接口操纵netfilter")])]),s._v(" "),t("h3",{attrs:{id:"nat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nat"}},[s._v("#")]),s._v(" NAT")]),s._v(" "),t("ul",[t("li",[s._v("相当于不同网络间的转接口")])])])}),[],!1,null,null,null);a.default=e.exports}}]);